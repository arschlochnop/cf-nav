name = "cf-nav-backend"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# 环境变量配置
# 注意：JWT_SECRET 必须使用 `wrangler secret put JWT_SECRET` 命令设置，不要写在这里！
[vars]
ENVIRONMENT = "production"
ALLOWED_ORIGINS = ""  # 部署后填入 Pages 域名，如 "https://cf-nav.pages.dev"

# D1 数据库绑定
[[d1_databases]]
binding = "DB"
database_name = "cf-nav-db"
database_id = "your-database-id-here"  # 运行 wrangler d1 create 后替换

# 开发环境配置
# 注意：开发环境的 JWT_SECRET 也需要用 `wrangler secret put JWT_SECRET --env dev` 设置
[env.dev]
name = "cf-nav-backend-dev"
vars = { ENVIRONMENT = "development" }

[[env.dev.d1_databases]]
binding = "DB"
database_name = "cf-nav-db"
database_id = "your-dev-database-id-here"

# KV 命名空间（用于缓存，可选）
# [[kv_namespaces]]
# binding = "CACHE"
# id = "your-kv-namespace-id"

# 速率限制（可选）
# [limits]
# cpu_ms = 50
