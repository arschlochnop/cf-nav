name = "cf-nav-backend"
main = "src/index.ts"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]

# 环境变量配置
# 注意：JWT_SECRET 必须使用 `wrangler secret put JWT_SECRET` 命令设置，不要写在这里！
[vars]
ENVIRONMENT = "production"
ALLOWED_ORIGINS = "https://cf-nav.pages.dev,https://87227857.cf-nav.pages.dev,https://fce7ecbb.cf-nav.pages.dev"  # Pages 生产域名和部署预览域名

# D1 数据库绑定
[[d1_databases]]
binding = "DB"
database_name = "cf-nav-db"
database_id = "2ad8477e-df63-485d-be83-16ffb5e54264"

# 开发环境配置
# 注意：开发环境的 JWT_SECRET 也需要用 `wrangler secret put JWT_SECRET --env dev` 设置
[env.dev]
name = "cf-nav-backend-dev"
vars = { ENVIRONMENT = "development", ALLOWED_ORIGINS = "" }

[[env.dev.d1_databases]]
binding = "DB"
database_name = "cf-nav-db-dev"
database_id = "da91ecb2-9e89-487e-8e28-96811d3a0bfa"

# KV 命名空间（用于缓存，可选）
# [[kv_namespaces]]
# binding = "CACHE"
# id = "your-kv-namespace-id"

# 速率限制（可选）
# [limits]
# cpu_ms = 50
